<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploy Gramola With GitOps :: Street Java on OpenShift</title>
    <link rel="canonical" href="https://atarazana.github.io/street-java-on-openshift-guide/street-java-on-openshift-guide/05-deploy-gramola-with-gitops.html">
    <meta name="generator" content="Antora 3.0.0">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="https://atarazana.github.io/street-java-on-openshift-guide">Street Java on OpenShift</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Books</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">CheatSheets</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">CheatSheet A</a>
            <a class="navbar-item" href="#">CheatSheet B</a>
            <a class="navbar-item" href="#">CheatSheet C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Upcoming Events</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Event A</a>
            <a class="navbar-item" href="#">Event B</a>
            <a class="navbar-item" href="#">Event C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Tutorial A</a>
            <a class="navbar-item" href="#">Tutorial B</a>
            <a class="navbar-item" href="#">Tutorial C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="street-java-on-openshift-guide" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html" class=" query-params-link">Street Java on OpenShift</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">1. Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#prerequisite">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#openshift">Setup OpenShift 4</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#download-tutorial">Get tutorial sources</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-prepare-cluster.html">2. Prepare Cluster</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-prepare-cluster.html#deploying-core-components">Deploying core components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-prepare-cluster.html#high-level-tests">High Level Tests</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-prepare-cluster.html#checking-quay">Checking Quay</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="03-deploy-the-app.html">3. Deploy The App</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-deploy-the-app.html#checking-helm-cli">Checking helm</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="03-deploy-the-app.html#installing-street-java">Installing Street Java</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-limit-what.html">4. Limit What?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-limit-what.html#checking-deployments">Checking Deployments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-limit-what.html#limits">Limits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-limit-what.html#limitrange-anatomy">LimitRange Anatomy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-limit-what.html#getting-rid-of-the-limirange">Getting Rid of the LimitRange</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-limit-what.html#checking-the-app">Checking the App</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-deploy-a-new-version.html">5. Deploy New Version</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-deploy-a-new-version.html#anatomy-of-your-chart">Anatomy of your Chart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-deploy-a-new-version.html#deploying-gramola">Deploying Gramola</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-deploy-a-new-version.html#deploying-gramola-additional">Deploying Gramola++</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="05-deploy-a-new-version.html#argocd-ui-filtering">ArgoCD UI Filtering</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-deploy-cicd-pipelines-with-gitops.html">6. Deploy CICD Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-deploy-cicd-pipelines-with-gitops.html#create-root-account-in-quay">Create Quay Robot Acc.</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-deploy-cicd-pipelines-with-gitops.html#deploying-cicd-pipelines">Deploying CICD Pipelines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-deploy-cicd-pipelines-with-gitops.html#create-git-secret">Create Git Secret</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-deploy-cicd-pipelines-with-gitops.html#create-registry-secret">Create Registry Secret</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="06-deploy-cicd-pipelines-with-gitops.html#grant-pull-permissions">Granting Pull Permissions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="07-checking-cicd-pipelines.html">7. Checking CICD Pipelines</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="07-checking-cicd-pipelines.html#overview">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="07-checking-cicd-pipelines.html#tekton-triggers">Tekton Triggers</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="08-create-pipeline-webhooks.html">8. Create Pipelines Webhooks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-create-pipeline-webhooks.html#pipeline-webhooks">Pipelines Webhooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-create-pipeline-webhooks.html#create-ci-webhooks">Create CI Webhooks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="08-create-pipeline-webhooks.html#create-cd-webhooks">Create CD Webhooks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="09-test-cicd-pipelines.html">9. Check Pipeline Webhooks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-test-cicd-pipelines.html#check-events-ci-web-hook">Check Events CI Web Hook</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-test-cicd-pipelines.html#check-events-cd-web-hook">Check Events CD Web Hook</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-test-cicd-pipelines.html#check-gateway-ci-web-hook">Check Gateway CI Web Hook</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="09-test-cicd-pipelines.html#check-gateway-cd-web-hook">Check Gateway CD Web Hook</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="10-end-to-end-test.html">10. End to End Test</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="10-end-to-end-test.html#introduction">Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="10-end-to-end-test.html#current-status">Ⓐ Current Status</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="10-end-to-end-test.html#change-the-code">Ⓑ Change the code</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="10-end-to-end-test.html#run-ci-pipeline">Ⓒ Run CI pipeline</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="10-end-to-end-test.html#running-cd-pipeline-dev">Ⓓ Run CD pipeline (<code>dev</code>)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="10-end-to-end-test.html#running-cd-pipeline-test">Ⓔ Run CD pipeline (<code>test</code>)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Street Java on OpenShift</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Street Java on OpenShift</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">Street Java on OpenShift</a></li>
    <li><a href="05-deploy-gramola-with-gitops.html">Deploy Gramola With GitOps</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/atarazana/street-java-on-openshift-guide/edit/main/documentation/modules/ROOT/pages/05-deploy-gramola-with-gitops.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Deploy Gramola With GitOps</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>As we have already explained in the introduction the main objective of this guide is introduce you to <strong>GitOps</strong> taking <strong>Gramola</strong> as the example application we want to deploy.</p>
</div>
<div class="paragraph">
<p>In this chapter you&#8217;re going to deploy Gramola using <strong>ArgoCD</strong> hence you&#8217;re not going to create the descriptors yourself. Instead <strong>ArgoCD</strong> will <strong>go</strong> to the <strong>source of truth</strong> (<em>git url, path and revision</em>), and  <strong>apply</strong> those descriptors in the defined <strong>destination</strong> (<em>cluster and namespace</em>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="concepts"><a class="anchor" href="#concepts"></a>Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you can imagine there should be an object <strong>ArgoCD</strong> can rely on to store both <strong>spec&#8594;source</strong> and <strong>spec&#8594;destination</strong>, this object is the <code>Application</code> object. This is an example of an <code>Application</code> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: events-app-dev-user1 <i class="conum" data-value="1"></i><b>(1)</b>
  namespace: openshift-gitops
  finalizers:
    - resources-finalizer.argocd.argoproj.io
  labels:
    app.kubernetes.io/instance: gramola-root-app-dev-user1
spec:
  project: gramola-project-dev
  source: <i class="conum" data-value="2"></i><b>(2)</b>
    repoURL: <a href="https://{gitea-host}/user1/gramola.git" class="bare">https://{gitea-host}/user1/gramola.git</a>
    targetRevision: HEAD
    path: events-deployment/overlays/dev
    plugin:
      name: kustomized-helm <i class="conum" data-value="4"></i><b>(4)</b>
      env:
        - name: DESTINATION_NAME
          value: in-cluster
        - name: BASE_REPO_URL
          value: <a href="https://{gitea-host}/user1/gramola" class="bare">https://{gitea-host}/user1/gramola</a>
        - name: NAMESPACE_SUFFIX
          value: '-user1'
  destination: <i class="conum" data-value="3"></i><b>(3)</b>
    name: in-cluster
    namespace: gramola-dev-user1
  syncPolicy:
    automated: {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Name of the application</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Source of truth, git url, path, revision and plugin to use</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Defines the destination of the descriptors found in the source of truth</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Plugin used to get the descriptors from the source git repository</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The broad concept of <code>Application</code> usually implies several components and/or microservices if you will. This means that in general when we talk about applications in real life they are more applications of applications or root applications. Don&#8217;t worry this is covered in <strong>ArgoCD</strong> with the concept <code>Application</code> the only thing you do is point the root application to a source where there are other <code>Applications</code> that could potentially point to other <code>Applications</code>, etc.</p>
</div>
<div class="paragraph">
<p>For instance in Gramola we will need to define one root application per environment, one for <code>dev</code> and one another for <code>test</code>. In this specific case, we would need to define a root app as the mother of a couple of root apps, one for <code>dev</code> and one for <code>test</code>, right? Something like this.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/gramola-root-app.png" alt="Gramola Root App">
</div>
</div>
<div class="paragraph">
<p>For these situations where there are little differences between sibling applications ArgoCD has another and very powerful object the <code>ApplicationSet</code>. An <code>ApplicationSet</code> is basically an <code>Application</code> template that can be fed with values generated by a generator.</p>
</div>
<div class="paragraph">
<p>We&#8217;re going to learn about <code>ApplicationSets</code> in the next chapter.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-gramola"><a class="anchor" href="#deploying-gramola"></a>Deploying Gramola</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Well, it&#8217;s time to use ArgoCD to deploy Gramola, as we have advanced we&#8217;re going to define an <code>ApplicationSet</code> that uses a <strong>generator</strong> to create an <code>Application</code> object for each of the environments we need: <code>dev</code> and <code>test</code> in this case.</p>
</div>
<div class="paragraph">
<p>You have to run the next command that created the <code>ApplicationSet</code> object that deploys Gramola in <code>dev</code> and <code>test</code> by using a list generator<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> and deploys the descriptors obtained by using the helm<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> plugin.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can use the value of any of the properties defined in the elements listed in the generator (spec&#8594;generators&#8594;list&#8594;elements), in this case <code>env</code> and <code>desc</code>. In order to use a value in the spec&#8594;template area use double curly braces as you would in helm <code>{{ env }}</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export USERNAME="%USERNAME%"
cat &lt;&lt;EOF | oc apply -n {root-apps-namespace} -f -
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: gramola-${USERNAME}
  namespace: openshift-gitops
  labels:
    argocd-root-app: "true"
    username: ${USERNAME}
spec:
  generators:
  - list:
      elements:
      - env: dev
        desc: "Gramola Dev"
      - env: test
        desc: "Gramola Test"
  template:
    metadata:
      name: gramola-root-app-{{ env }}-${USERNAME}
      namespace: openshift-gitops
      labels:
        argocd-root-app: "true"
        username: ${USERNAME}
      finalizers:
      - resources-finalizer.argocd.argoproj.io
    spec:
      destination:
        namespace: openshift-gitops
        name: in-cluster
      project: default
      syncPolicy:
        automated:
          selfHeal: true
      source:
        helm:
          parameters:
            - name: baseRepoUrl
              value: <a href="https://{gitea-host}/%USERNAME%/gramola" class="bare">https://{gitea-host}/%USERNAME%/gramola</a>
            - name: namespaceSuffix
              value: "-${USERNAME}"
            - name: username
              value: "%USERNAME%"
        path: apps/{{ env }}
        repoURL: <a href="https://{gitea-host}/%USERNAME%/gramola.git" class="bare">https://{gitea-host}/%USERNAME%/gramola.git</a>
        targetRevision: HEAD
EOF</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see something like.</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">application.argoproj.io/gramola-%USERNAME% created</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s go to ArgoCD console and see how it&#8217;s going on. Please copy the next link and open it in a new tab.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">https://openshift-gitops-server-openshift-gitops.apps.%BASE_SUBDOMAIN%/applications</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the expected result once all images have been pulled and the services are deployed completely.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/argocd-gramola-deployed.png" alt="ArgoCD Gramola Deployed">
</div>
</div>
<div class="paragraph">
<p>You can also have a look to the <code>dev</code> environment using the OpenShift console. Please, copy the next link and paste it in a new tab.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">https://console-openshift-console.apps.%BASE_SUBDOMAIN%/topology/ns/gramola-dev-%USERNAME%?view=graph</code></pre>
</div>
</div>
<div class="paragraph">
<p>To change to the <code>test</code> environment, just select <code>gramola-test-%USERNAME%</code> as in the next picture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/openshift-console-project-selection.png" alt="Project Selection">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s test gramola, in both environments by clicking on the URL icon of <code>gateway</code> as in the next picture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/gramola-gateway-topology-url.png" alt="Gateway URL">
</div>
</div>
<div class="paragraph">
<p>You should see this simple user interface.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Please take into account this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first green area shows the status of the <code>Gateway</code> and also the service name as stated in <code>src/main/resources/application.properties</code></p>
</li>
<li>
<p>The second green area shows the status of the backend service <code>Events</code> and also the service name as stated in <code>src/main/resources/application.properties</code></p>
</li>
<li>
<p>This interface refreshes itself every 2 seconds, so if you change the name of the service or there is a problem you should be able to see it here</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/gramola-gateway-ui-1.png" alt="Gateway UI">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-gramola-additional"><a class="anchor" href="#deploying-gramola-additional"></a>Deploying Gramola++</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If an additional cluster has been set up in chapter <a href="04-prepare-argocd.html#register-additional-clusters" class="xref page">Register Additional Clusters</a> then you can create another <code>ApplicationSet</code> where the destination cluster is the one you defined previously instead of the default (<code>in-cluster</code>) cluster.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export USERNAME="%USERNAME%"
cat &lt;&lt;EOF | oc apply -n {root-apps-namespace} -f -
apiVersion: argoproj.io/v1alpha1
kind: ApplicationSet
metadata:
  name: gramola-cloud-${USERNAME}
  namespace: openshift-gitops
  labels:
    argocd-root-app: "true"
    username: ${USERNAME}
spec:
  generators:
  - list:
      elements:
      - env: test-cloud
        desc: "Gramola Test"
  template:
    metadata:
      name: gramola-root-app-{{ env }}-${USERNAME}
      namespace: openshift-gitops
      labels:
        argocd-root-app: "true"
        username: ${USERNAME}
      finalizers:
      - resources-finalizer.argocd.argoproj.io
    spec:
      destination:
        namespace: openshift-gitops
        name: in-cluster
      project: default
      syncPolicy:
        automated:
          selfHeal: true
      source:
        helm:
          parameters:
            - name: baseRepoUrl
              value: <a href="https://{gitea-host}/%USERNAME%/gramola" class="bare">https://{gitea-host}/%USERNAME%/gramola</a>
            - name: namespaceSuffix
              value: "-${USERNAME}"
            - name: username
              value: "%USERNAME%"
        path: apps/{{ env }}
        repoURL: <a href="https://{gitea-host}/%USERNAME%/gramola.git" class="bare">https://{gitea-host}/%USERNAME%/gramola.git</a>
        targetRevision: HEAD
EOF</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly if you created the root app for the additional cluster you should see&#8230;&#8203;</p>
</div>
<div class="listingblock console-output">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">application.argoproj.io/gramola-cloud-user1 created</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please go to ArgoCD console and see how it&#8217;s going on. Please copy the next link and open it in a new tab.</p>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">https://openshift-gitops-server-openshift-gitops.apps.%BASE_SUBDOMAIN%/applications?cluster=aws-managed1</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the expected result once all images have been pulled and the services are deployed completely.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/argocd-gramola-cloud-deployed.png" alt="ArgoCD Gramola Deployed">
</div>
</div>
<div class="paragraph">
<p>You can also have a look to the <code>test</code> environment in the additional cluster using the OpenShift console. Please, copy the next link and paste it in a new tab, please use these credentials:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>USERNAME:</strong> %USERNAME%</p>
</li>
<li>
<p><strong>PASSWORD:</strong> %PASSWORD%</p>
</li>
</ul>
</div>
<div class="listingblock console-input">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">https://console-openshift-console.apps.%ADDITIONAL_BASE_SUBDOMAIN%/topology/ns/gramola-test-%USERNAME%?view=graph</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="argocd-ui-filtering"><a class="anchor" href="#argocd-ui-filtering"></a>ArgoCD UI Filtering</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ArgoCD has a lots of options to filter objects, namely:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Favorites</p>
</li>
<li>
<p>Sync Status</p>
</li>
<li>
<p>Health Status</p>
</li>
<li>
<p>Labels</p>
</li>
<li>
<p>Projects</p>
</li>
<li>
<p>Clusters</p>
</li>
<li>
<p>Namespaces</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/argocd-ui-filtering-1.png" alt="ArgoCD Filtering Area">
</div>
</div>
<div class="paragraph">
<p>Feel free to play with all of them and have a taste of how they work.</p>
</div>
<div class="paragraph">
<p>Once you&#8217;re done please try this one, <code>Labels</code> and choose <code>username=%USERNAME%</code> as in the next picture, if you&#8217;re running this guide along with other users in the same cluster, you&#8217;ll find it very useful to see only your objects.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/argocd-ui-filtering-2.png" alt="ArgoCD Filtering Area">
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/applicationset/Generators/" class="bare">https://argo-cd.readthedocs.io/en/stable/operator-manual/applicationset/Generators/</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. <a href="https://argoproj.github.io/argo-cd/user-guide/helm/" class="bare">https://argoproj.github.io/argo-cd/user-guide/helm/</a>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
